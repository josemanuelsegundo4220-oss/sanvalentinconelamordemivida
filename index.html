<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VALENTINE</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Great+Vibes&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#0a1530;
      --bg2:#0c3b6b;
      --pink:#ff4fa3;
      --pink2:#ff7ac3;
      --shadow:#00000055;
      --green:#34c759;
      --red:#ff3b30;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      height:100vh;
      font-family:"Press Start 2P", system-ui, sans-serif;
      overflow:hidden;
      background: linear-gradient(180deg, var(--bg1), var(--bg2));
    }

    .stage{
      position:relative;
      width:100%;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
    }

    .screen{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:18px;
      opacity:0;
      pointer-events:none;
      transition: opacity .35s ease;
    }
    .screen.active{
      opacity:1;
      pointer-events:auto;
    }

    .title{
      font-size:34px;
      letter-spacing:2px;
      color:var(--pink);
      text-shadow:4px 4px 0 #000;
      text-align:center;
      margin:0 18px;
    }

    .hint{
      font-size:12px;
      color:#d9d9d9;
      text-shadow:3px 3px 0 #000;
      text-align:center;
      line-height:1.6;
      margin:0 18px;
    }

    .card{
      width:min(520px, 92vw);
      background:#fff;
      border-radius:18px;
      padding:22px 18px;
      box-shadow:0 14px 35px var(--shadow);
    }

    .frame{
      border:6px solid var(--pink);
      border-radius:18px;
      padding:20px 14px;
      background:linear-gradient(180deg, #ffffff, #fff6fb);
      position:relative;
    }
    .frame::before{
      content:"";
      position:absolute;
      inset:10px;
      border:4px solid var(--pink2);
      border-radius:14px;
      pointer-events:none;
      opacity:.9;
    }

    .question{
      color:var(--pink);
      text-shadow:3px 3px 0 #000;
      font-size:18px;
      text-align:center;
      line-height:1.6;
      margin:6px 12px 18px;
      position:relative;
      z-index:2;
    }

    .btns{
      position:relative;
      min-height:190px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:16px;
      padding:8px 0 6px;
      z-index:2;
    }

    .btn{
      width:170px;
      height:56px;
      border:none;
      border-radius:12px;
      font-family:inherit;
      font-size:16px;
      color:#fff;
      cursor:pointer;
      box-shadow:0 10px 0 #000;
      transform: translateY(0);
      transition: transform .05s ease;
      user-select:none;
      position:relative;
      z-index:3;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    .btn:active{
      transform: translateY(6px);
      box-shadow:0 4px 0 #000;
    }
    .btn.green{ background:var(--green); }

    .btn.red{
      background:var(--red);
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:10px;
      z-index:1;
    }

    .shake{ animation: shake .25s linear 1; }
    @keyframes shake{
      0%{ transform: translateX(0); }
      20%{ transform: translateX(-6px); }
      40%{ transform: translateX(6px); }
      60%{ transform: translateX(-5px); }
      80%{ transform: translateX(5px); }
      100%{ transform: translateX(0); }
    }

    .flash{ animation: flashPink 0.15s ease 1; }
    @keyframes flashPink{
      0%   { background-color: rgba(255, 79, 163, 0.0); }
      50%  { background-color: rgba(255, 79, 163, 0.35); }
      100% { background-color: rgba(255, 79, 163, 0.0); }
    }

    .toast{
      position:absolute;
      top:18px;
      left:50%;
      transform:translateX(-50%);
      background:#00000066;
      border:2px solid #ffffff22;
      color:#fff;
      padding:10px 14px;
      border-radius:12px;
      font-size:10px;
      text-shadow:2px 2px 0 #000;
      opacity:0;
      pointer-events:none;
      transition: opacity .15s ease, transform .15s ease;
      z-index:50;
      max-width:92vw;
      text-align:center;
    }
    .toast.show{
      opacity:1;
      transform:translateX(-50%) translateY(4px);
    }

    .msg{
      font-size:12px;
      line-height:1.9;
      text-align:center;
      margin:6px 18px 10px;
    }

    .big{
      font-size:20px;
      color:var(--pink);
      text-shadow:3px 3px 0 #000;
      text-align:center;
      margin-bottom:12px;
    }

    .emojiRow{
      font-size:28px;
      text-align:center;
      margin-top:10px;
    }

    .credit{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:22px;
      padding:10px 14px;
      font-size:10px;
      color:#eaeaea;
      background:#00000055;
      border-radius:12px;
      text-shadow:2px 2px 0 #000;
      max-width:92vw;
      text-align:center;
      z-index: 5;
    }

    .hearts{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .heart{
      position:absolute;
      top:-40px;
      font-size:26px;
      opacity:.95;
      animation: fall linear forwards;
      filter: drop-shadow(0 6px 0 #00000033);
    }
    @keyframes fall{
      to{ transform: translateY(calc(100vh + 80px)); }
    }

    .softPinkBg{
      background: radial-gradient(circle at 30% 20%, #ffd1e6, #ffb6d8 40%, #ff9fcd 70%, #ff88c2);
    }

    @media (max-width:420px){
      .title{ font-size:26px; }
      .question{ font-size:16px; }
      .btn{ width:160px; }
    }

    /* === COLLAGE FINAL === */
    #screenCollage {
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: white;
      padding: 20px;
      overflow-y: auto;
    }

    .collage-title {
      text-align: center;
      font-size: 28px;
      margin: 0 0 20px 0;
      text-shadow: 3px 3px 0 #000;
      color: var(--pink2);
    }

    .collage {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      max-width: 900px;
      margin: 0 auto;
    }

    .collage img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      border-radius: 18px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.4);
      transition: transform 0.3s ease;
    }

    .collage img:hover { transform: scale(1.05); }

    .collage img.main {
      grid-column: span 3;
      height: 320px;
    }

    /* === PRE INICIO (CORAZ√ìN) === */
    #screenPre{
      gap: 10px;
    }

    .loveBtn{
      appearance:none;
      border:none;
      background:transparent;
      cursor:pointer;
      padding:0;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      user-select:none;
      position:relative;
      transform: translateY(0);
      filter: drop-shadow(0 16px 0 #00000055);
      animation: pulse 1.25s ease-in-out infinite;
    }

    @keyframes pulse{
      0%,100%{ transform: scale(1) translateY(0); }
      50%{ transform: scale(1.06) translateY(-2px); }
    }

    .loveBtn::after{
      content:"";
      position:absolute;
      left:50%;
      top:50%;
      width:220px;
      height:220px;
      transform:translate(-50%,-50%);
      border-radius:999px;
      background: radial-gradient(circle, rgba(255,255,255,0.20), rgba(255,255,255,0.0) 60%);
      opacity:.55;
      pointer-events:none;
      animation: halo 1.25s ease-in-out infinite;
    }

    @keyframes halo{
      0%,100%{ transform:translate(-50%,-50%) scale(1); opacity:.45; }
      50%{ transform:translate(-50%,-50%) scale(1.12); opacity:.65; }
    }

    .loveBtn.opening{
      animation:none;
      transform: scale(1.08);
    }

    .loveBtn.opening svg{
      animation: openPop .55s ease forwards;
    }

    @keyframes openPop{
      0%{ transform: scale(1); opacity:1; }
      70%{ transform: scale(1.18); opacity:1; }
      100%{ transform: scale(0.85); opacity:0; }
    }

    .loveText{
      font-family: "Great Vibes", cursive;
      font-size: 64px;
      fill: #ffffff;
      stroke: rgba(0,0,0,0.45);
      stroke-width: 3px;
      paint-order: stroke fill;
      letter-spacing: 1px;
    }

    @media (max-width:420px){
      .loveText{ font-size: 54px; }
    }

    /* === PANTALLA VIDEOS (NUEVA) === */
    #screenVideos{
      background: linear-gradient(135deg, #0b1026, #241a52, #0b1026);
      padding: 20px;
    }

    .videoWrap{
      width: min(900px, 92vw);
      height: min(520px, 62vh);
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius: 18px;
      position:relative;
      overflow:hidden;
      box-shadow: 0 14px 35px var(--shadow);
      background: rgba(0,0,0,0.35);
      border: 4px solid rgba(255,255,255,0.18);
    }

    #videoPlayer{
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: #000;
    }

    /* animaciones tipo ‚Äúslide‚Äù */
    .fadeIn{
      animation: fadeIn .55s ease both;
    }
    @keyframes fadeIn{
      from{ opacity:0; transform: scale(0.98); }
      to{ opacity:1; transform: scale(1); }
    }

    .fadeOut{
      animation: fadeOut .45s ease both;
    }
    @keyframes fadeOut{
      from{ opacity:1; transform: scale(1); }
      to{ opacity:0; transform: scale(0.985); }
    }
  </style>
</head>

<body>
  <div class="stage" id="stage">
    <div class="hearts" id="hearts"></div>
    <div class="toast" id="toast">No tan r√°pido üëÄ</div>

    <section class="screen active" id="screenPre" aria-label="Inicio amor">
      <button class="loveBtn" id="btnLove" type="button" aria-label="Te amo">
        <svg width="360" height="320" viewBox="0 0 360 320" role="img" aria-hidden="true">
          <defs>
            <linearGradient id="gHeart" x1="0" x2="1" y1="0" y2="1">
              <stop offset="0" stop-color="#ff5aa8"/>
              <stop offset="1" stop-color="#ff2e8f"/>
            </linearGradient>
            <linearGradient id="gBow" x1="0" x2="1" y1="0" y2="0">
              <stop offset="0" stop-color="#ffd1e6"/>
              <stop offset="1" stop-color="#ff9fcd"/>
            </linearGradient>
          </defs>

          <path d="M180 290
                   C 80 230, 30 170, 45 110
                   C 58 60, 105 45, 140 65
                   C 160 77, 172 98, 180 112
                   C 188 98, 200 77, 220 65
                   C 255 45, 302 60, 315 110
                   C 330 170, 280 230, 180 290 Z"
                fill="url(#gHeart)"/>

          <path d="M90 140
                   C 120 115, 155 115, 170 145
                   C 155 175, 120 175, 90 150 Z"
                fill="url(#gBow)" opacity="0.95"/>
          <path d="M270 140
                   C 240 115, 205 115, 190 145
                   C 205 175, 240 175, 270 150 Z"
                fill="url(#gBow)" opacity="0.95"/>
          <ellipse cx="180" cy="148" rx="18" ry="14" fill="#ffb6d8" opacity="0.95"/>

          <text x="180" y="170" text-anchor="middle" class="loveText">TE AMO</text>
        </svg>
      </button>

      <div class="credit">Con AMOR tu ING FAVORITO</div>
    </section>

    <section class="screen" id="screenStart" aria-label="Inicio">
      <h1 class="title">VALENTINE</h1>
      <div class="hint">Toca la pantalla<br>para comenzar...</div>
      <div class="credit">TE AMO MUCHO BONITA</div>
    </section>

    <section class="screen" id="screenAsk" aria-label="Pregunta">
      <div class="card">
        <div class="frame">
          <div class="question" id="questionText"></div>
          <div class="btns" id="btnArea">
            <button class="btn green" id="btnYes" type="button">SI</button>
            <button class="btn red" id="btnNo" type="button">NO</button>
          </div>
        </div>
      </div>
      <div class="credit">Con AMOR tu ING FAVORITO</div>
    </section>

    <section class="screen" id="screenYes" aria-label="Acept√≥">
      <div class="card">
        <div class="frame">
          <div class="big">¬°Gracias por aceptar!</div>
          <div class="msg" id="finalMsg"></div>
          <div class="emojiRow">üíû üíñ üíù üíò üíó</div>
        </div>
      </div>
      <div class="credit">Feliz San Valent√≠n Mi Amor</div>
    </section>

    <section class="screen" id="screenCollage" aria-label="Collage">
      <h2 class="collage-title">Nuestros recuerdos üíï</h2>
      <div class="collage">
        <img src="fotos/1.jpeg" class="main" alt="">
        <img src="fotos/2.jpeg" alt="">
        <img src="fotos/3.jpeg" alt="">
        <img src="fotos/4.jpeg" alt="">
        <img src="fotos/5.jpeg" alt="">
        <img src="fotos/6.jpeg" alt="">
        <img src="fotos/7.jpeg" alt="">
        <img src="fotos/8.jpeg" alt="">
        <img src="fotos/9.jpeg" alt="">
        <img src="fotos/10.jpeg" alt="">
      </div>
      <div class="credit">Siempre t√∫ y yo üíñ</div>
    </section>

    <!-- ‚úÖ NUEVA PANTALLA DE VIDEOS -->
    <section class="screen" id="screenVideos" aria-label="Videos">
      <div class="videoWrap">
        <video id="videoPlayer" autoplay muted playsinline></video>
      </div>
      <div class="credit">Nuestros momentos üíû</div>
    </section>
  </div>

  <audio id="bgMusic" loop preload="auto">
    <source src="musica.mp3" type="audio/mpeg">
  </audio>

  <script>
    const stage = document.getElementById("stage");
    const hearts = document.getElementById("hearts");

    const screenPre = document.getElementById("screenPre");
    const screenStart = document.getElementById("screenStart");
    const screenAsk = document.getElementById("screenAsk");
    const screenYes = document.getElementById("screenYes");
    const screenCollage = document.getElementById("screenCollage");
    const screenVideos = document.getElementById("screenVideos"); // üëà nuevo

    const btnLove = document.getElementById("btnLove");
    const btnYes = document.getElementById("btnYes");
    const btnNo = document.getElementById("btnNo");
    const btnArea = document.getElementById("btnArea");

    const questionText = document.getElementById("questionText");
    const finalMsg = document.getElementById("finalMsg");
    const toast = document.getElementById("toast");

    const bgMusic = document.getElementById("bgMusic");

    const videoPlayer = document.getElementById("videoPlayer"); // üëà nuevo

    // ‚úÖ LISTA DE VIDEOS (deben existir en /videos/)
    // Ejemplo: videos/1.mp4, videos/2.mp4, ...
    const videoList = [
      "videos/1.mp4",
      "videos/2.mp4",
      "videos/3.mp4",
      "videos/4.mp4",
      "videos/5.mp4"
    ];

    let videoIndex = 0;

    function showScreen(screen){
      [screenPre, screenStart, screenAsk, screenYes, screenCollage, screenVideos].forEach(s => s.classList.remove("active"));
      screen.classList.add("active");

      if(screen === screenAsk || screen === screenYes || screen === screenCollage || screen === screenVideos){
        stage.classList.add("softPinkBg");
      } else {
        stage.classList.remove("softPinkBg");
      }
    }

    function playMusic(){
      if(!bgMusic) return;
      bgMusic.volume = 0.8;
      bgMusic.muted = false;
      const p = bgMusic.play();
      if(p !== undefined){ p.catch(() => {}); }
    }

    const NOMBRE_PREGUNTA = "Yessica Arleth";
    const NOMBRE_FINAL = "Bonita";

    questionText.innerHTML = `${NOMBRE_PREGUNTA},<br>¬øquieres ser mi San Valentin?`;
    finalMsg.innerHTML =
      "Me haces muy feliz.<br>" +
      "Eres lo mejor de mi vida.<br><br>" +
      `Te quiero mucho, ${NOMBRE_FINAL}.<br>` +
      "Gracias por decir que si.";

    let audioReady = false;
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    const audioCtx = AudioCtx ? new AudioCtx() : null;

    async function unlockAudio(){
      if(!audioCtx || audioReady) return;
      try{
        await audioCtx.resume();
        audioReady = true;
      }catch(e){}
    }

    function playTap(){
      if(!audioCtx || !audioReady) return;
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.type = "sine";
      o.frequency.value = 680;
      g.gain.value = 0.0001;

      o.connect(g);
      g.connect(audioCtx.destination);

      const now = audioCtx.currentTime;
      g.gain.setValueAtTime(0.0001, now);
      g.gain.exponentialRampToValueAtTime(0.12, now + 0.01);
      g.gain.exponentialRampToValueAtTime(0.0001, now + 0.08);

      o.start(now);
      o.stop(now + 0.09);
    }

    function flashScreen(){
      stage.classList.remove("flash");
      void stage.offsetWidth;
      stage.classList.add("flash");
    }

    let toastTimer = null;
    function showToast(text){
      toast.textContent = text;
      toast.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toast.classList.remove("show"), 700);
    }

    function startIfOnStart(){
      if(screenStart.classList.contains("active")) showScreen(screenAsk);
    }

    // ‚úÖ Videos: cargar y reproducir
    function playCurrentVideo(){
      if(!videoPlayer || videoList.length === 0) return;

      videoPlayer.classList.remove("fadeIn");
      void videoPlayer.offsetWidth;

      videoPlayer.src = videoList[videoIndex];
      videoPlayer.load();

      const p = videoPlayer.play();
      if(p !== undefined){ p.catch(() => {}); }

      videoPlayer.classList.add("fadeIn");
    }

    function nextVideo(){
      if(videoList.length === 0) return;
      videoIndex = (videoIndex + 1) % videoList.length;
      playCurrentVideo();
    }

    // cuando termine un video, pasa al siguiente
    videoPlayer.addEventListener("ended", () => {
      nextVideo();
    });

    btnLove.addEventListener("click", async (e) => {
      e.preventDefault();
      await unlockAudio();
      playMusic(); // iPhone: debe ser por toque
      btnLove.classList.add("opening");
      setTimeout(() => {
        btnLove.classList.remove("opening");
        showScreen(screenStart);
      }, 600);
    });

    window.addEventListener("pointerdown", async () => {
      await unlockAudio();
      playMusic();
      startIfOnStart();
    });

    window.addEventListener("keydown", async () => {
      await unlockAudio();
      playMusic();
      startIfOnStart();
    });

    btnYes.addEventListener("click", (e) => {
      e.stopPropagation();
      showScreen(screenYes);

      // ‚úÖ a los 10s pasa al collage
      setTimeout(() => {
        showScreen(screenCollage);

        // ‚úÖ despu√©s de 10s en collage pasa a videos y empieza slideshow
        setTimeout(() => {
          showScreen(screenVideos);
          videoIndex = 0;
          playCurrentVideo();
        }, 10000);

      }, 10000);
    });

    function rand(min, max){ return Math.random() * (max - min) + min; }

    function shakeNo(){
      btnNo.classList.remove("shake");
      void btnNo.offsetWidth;
      btnNo.classList.add("shake");
    }

    function moveNoButton(){
      const area = btnArea.getBoundingClientRect();
      const noR = btnNo.getBoundingClientRect();
      const yesR = btnYes.getBoundingClientRect();

      const pad = 10;
      const maxX = area.width - noR.width - pad;
      const maxY = area.height - noR.height - pad;

      const forbid = {
        x1: (yesR.left - area.left) - 14,
        y1: (yesR.top  - area.top)  - 14,
        x2: (yesR.right - area.left) + 14,
        y2: (yesR.bottom - area.top) + 14,
      };

      let x, y, tries = 0;
      do{
        x = rand(pad, Math.max(pad, maxX));
        y = rand(pad, Math.max(pad, maxY));
        tries++;
      }while(
        tries < 30 &&
        x < forbid.x2 && (x + noR.width) > forbid.x1 &&
        y < forbid.y2 && (y + noR.height) > forbid.y1
      );

      btnNo.style.left = x + "px";
      btnNo.style.top = y + "px";
      btnNo.style.bottom = "auto";
      btnNo.style.transform = "none";
    }

    const frases = [
      "No tan r√°pido üëÄ",
      "¬øSegura? üòè",
      "Intenta otra vez üòÇ",
      "Ayyy no üò≥",
      "Ese bot√≥n no sirve üòå"
    ];
    function randomPhrase(){
      return frases[Math.floor(Math.random() * frases.length)];
    }

    btnNo.addEventListener("pointerdown", (e) => {
      e.preventDefault();
      playTap();
      shakeNo();
      flashScreen();
      showToast(randomPhrase());
      moveNoButton();
      if(navigator.vibrate) navigator.vibrate(60);
    });

    btnNo.addEventListener("mouseenter", () => {
      playTap();
      shakeNo();
      flashScreen();
      showToast(randomPhrase());
      moveNoButton();
    });

    function spawnHeart(){
      const el = document.createElement("div");
      el.className = "heart";
      const emojis = ["üíó","üíñ","üíû","üíò","üíù","üíì","üíü"];
      el.textContent = emojis[Math.floor(Math.random() * emojis.length)];
      el.style.left = rand(0, 100) + "vw";
      el.style.fontSize = rand(18, 34) + "px";
      el.style.animationDuration = rand(4.5, 9.5) + "s";
      hearts.appendChild(el);
      setTimeout(() => el.remove(), 10000);
    }
    setInterval(spawnHeart, 220);
  </script>
</body>
</html>












